import{u as D,b as B,D as O,o as I}from"./links.37929787.js";import N from"./BadBotBlocker.7a582d04.js";import{C as V}from"./Index.7ca727b3.js";import E from"./DatabaseTools.56a0559a.js";import{C as R}from"./index.c39be324.js";import{C as U}from"./Card.4fe92d12.js";import{C as Y}from"./Tabs.31f97451.js";import{C as H}from"./Index.9e89d7ca.js";import{C as z}from"./Upload.40656c75.js";import{C as K}from"./SettingsRow.b0e0fbda.js";import{B as P}from"./Checkbox.100811db.js";import{G,a as W}from"./Row.256ac4c7.js";import{r as a,o as i,c as h,d as g,w as d,I as M,J as T,b as p,D as w,z as m,a as l,f as A,B as C,g as F}from"./vue.runtime.esm-bundler.588d3a9f.js";import{_ as v}from"./_plugin-vue_export-helper.a6f24833.js";import{S as q}from"./Caret.4d98c50a.js";import J from"./HtaccessEditor.e5789ebf.js";import j from"./ImportExport.e57949b9.js";import Q from"./RobotsEditor.9b46a502.js";import X from"./SystemStatus.8eb925a1.js";import Z from"./WpCode.c4c838d8.js";import"./default-i18n.3881921e.js";import"./isArrayLikeObject.10b615a9.js";import"./Textarea.2ca1c9ed.js";import"./Tooltip.0e57efe0.js";import"./Slide.5fb4a175.js";/* empty css                                            */import"./license.08c84d9a.js";import"./upperFirst.d65414ba.js";import"./_stringToArray.a4422725.js";import"./allowed.d718ae23.js";/* empty css             */import"./params.f0608262.js";import"./constants.44daa6bb.js";/* empty css                                              */import"./SaveChanges.ea2d670b.js";import"./TruSeoHighlighter.ed998abe.js";import"./postContent.a843d374.js";import"./cleanForSlug.a67f7e84.js";import"./Ellipse.60ee808e.js";import"./toFinite.c2274946.js";/* empty css                                              */import"./Header.e6a5cb1f.js";import"./addons.dacbad81.js";import"./LicenseKeyBar.c2c1f525.js";import"./LogoGear.bbb9a3ba.js";import"./AnimatedNumber.113ba09d.js";import"./numbers.c7cb4085.js";import"./Logo.5c35a084.js";import"./Support.11e1bcbd.js";import"./Date.a5d89f77.js";import"./Exclamation.9bd52654.js";import"./Url.a35d07aa.js";import"./Gear.695eb859.js";import"./Network.eae8db1f.js";import"./ToolsSettings.3bc5d2b5.js";import"./Checkmark.cb1bb390.js";import"./Index.6783501d.js";import"./Blur.f4710b2c.js";import"./TruSeoScore.29220195.js";import"./Information.854046a2.js";import"./Editor.c5c83913.js";import"./tags.ef6a6bd6.js";import"./Plus.10a4ed4b.js";import"./History.5d4c6c33.js";import"./Refresh.46990afe.js";import"./Download.cebf33f1.js";import"./Drag.bfb81d29.js";import"./vue.runtime.esm-bundler.49781f74.js";import"./External.7d8382ba.js";import"./Row.53c6d3a6.js";const ee={setup(){return{rootStore:D()}},emits:["update"],components:{BaseCheckbox:P,GridColumn:G,GridRow:W},props:{loading:Boolean,disabled:Boolean},data(){return{options:{},strings:{updateOptions:this.$t.__("Update Options",this.$td)}}},mounted(){this.rootStore.aioseo.deprecatedOptions.forEach(e=>{e.enabled&&(this.options[e.value]=!0)})}},te={class:"aioseo-deprecated-options"},oe=l("br",null,null,-1),se=l("br",null,null,-1),ie=l("br",null,null,-1);function ne(e,o,n,u,t,r){const c=a("base-checkbox"),b=a("grid-column"),y=a("grid-row"),f=a("base-button");return i(),h("div",te,[g(y,{class:"settings"},{default:d(()=>[(i(!0),h(M,null,T(u.rootStore.aioseo.deprecatedOptions,(_,S)=>(i(),p(b,{key:S,xl:"6",sm:"12"},{default:d(()=>[g(c,{size:"medium",modelValue:t.options[_.value],"onUpdate:modelValue":k=>t.options[_.value]=k,disabled:n.disabled},{default:d(()=>[w(m(_.label),1)]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1024))),128))]),_:1}),oe,g(f,{type:"blue",size:"medium",onClick:o[0]||(o[0]=_=>e.$emit("update",t.options)),loading:n.loading,disabled:n.disabled},{default:d(()=>[w(m(t.strings.updateOptions),1)]),_:1},8,["loading","disabled"]),se,ie])}const re=v(ee,[["render",ne]]);const ae={setup(){return{optionsStore:B()}},computed:{infoItems(){return[{label:"Migrated Version",value:this.optionsStore.internalOptions.internal.migratedVersion},{label:"First Activated",value:this.optionsStore.internalOptions.internal.firstActivated!==0?O.fromMillis(this.optionsStore.internalOptions.internal.firstActivated*1e3).toFormat("MMMM d, yyyy"):!1}]}}},le={class:"v3-migration-info aioseo-description"},ce={class:"info-items"},de={key:0},ue={key:1};function pe(e,o,n,u,t,r){return i(),h("div",le,[l("ul",ce,[(i(!0),h(M,null,T(r.infoItems,(c,b)=>(i(),h("li",{key:b},[c.value?(i(),h("span",de,m(c.label),1)):A("",!0),c.value?(i(),h("span",ue,m(c.value),1)):A("",!0)]))),128))])])}const me=v(ae,[["render",pe]]);const he={setup(){return{rootStore:D(),toolsStore:I()}},components:{CoreAlert:R,CoreCard:U,CoreMainTabs:Y,CoreModal:H,CoreNetworkSiteSelector:z,CoreSettingsRow:K,DeprecatedOptions:re,MigrationInfo:me,SvgClose:q},props:{extraActions:{type:Array,required:!1}},data(){return{site:{},tabsKey:0,doingActionKey:0,activeTab:"general",currentAction:"",showAreYouSureModal:!1,doingAction:[],strings:{selectSite:"Select Site",cardLabel:"Debug",selectLabel:"Select a Debug Action:",buttonLabel:"Run Action",alertWarning:"Before you run any action, please make sure that you have fully read the description and understand the consequences as these cannot be reverted.",cannotBeUndone:"This action cannot be undone.",yesDoAction:"Yes, run this action",noChangedMind:"No, I changed my mind"},alertLink:this.$links.getPlainLink("Click here to open to the Scheduled Actions panel",this.rootStore.aioseo.urls.admin.scheduledActions,!0)}},computed:{areYouSureTitle(){return`Are you sure you want to run the "${this.currentAction.label}" action?`},tabs(){const e=this.$t.sprintf('<a href="%1$s" target="_blank">Scheduled Actions</a>',this.rootStore.aioseo.urls.admin.scheduledActions),o=this.rootStore.aioseo.data.isNetworkAdmin?"<br><strong>NOTE: If no site is selected, this will clear the network cache.</strong>":"",n=this.rootStore.aioseo.data.isNetworkAdmin?"<br><strong>NOTE: If no site is selected, this will clear the network plugin updates transient.</strong>":"";return[{slug:"general",name:"General",actions:[{label:"Clear Cache",slug:"clear-cache",shortDescription:`This action deletes all records of the <code>aioseo_cache</code> table in the database.${o}`,longDescription:"",showModal:!1,network:!0},{label:"Clear Plugin Updates Transient",slug:"clear-plugin-updates-transient",shortDescription:`This action clears the plugin updates transient, which forces WordPress Core to check for plugin updates.${n}`,longDescription:"",showModal:!1,network:!0},{label:"Readd Capabilities",slug:"readd-capabilities",shortDescription:"This action will readd our capabilities (access permissions) for all users.",longDescription:"",showModal:!1},{label:"Reset Data",slug:"reset-data",shortDescription:"This action will <strong>delete</strong> all our custom tables and options.",longDescription:"",showModal:!0}]},{slug:"sitemap",name:"Sitemap",actions:[{label:"Clear Image Data",slug:"clear-image-data",shortDescription:"This action removes all image data from the database, forcing a site-wide rescan via Action Scheduler.",longDescription:this.$t.sprintf("To speed up the image scan, go to %1$s and run the <code>aioseo_image_sitemap_scan</code> action.",e),showModal:!1}]},{slug:"migrations",name:"Migrations",actions:[{label:"Rerun V4+ Migrations",slug:"rerun-migrations",shortDescription:"This action will rerun all update migrations since 4.0.0, excluding the V3 migration.",longDescription:"",showModal:!0}]},{slug:"old-issues",name:"Old Issues",actions:[{label:"Remove Duplicates",slug:"remove-duplicates",shortDescription:"This action will delete any duplicate records that are found in the <code>aioseo_posts</code> and <code>aioseo_terms</code> tables.",longDescription:"",showModal:!1},{label:"Unescape Data",slug:"unescape-data",shortDescription:"This action will clean <code>aioseo_posts</code> and <code>aioseo_term</code> records whose data is corrupted.",longDescription:this.$t.sprintf("The action will trigger a routine which runs in batches via Action Scheduler. It may take some time for this routine to complete, To speed up this process, go to %1$s and run the <code>aioseo_unslash_escaped_data_posts</code> or <code>aioseo_unslash_escaped_data_terms</code> action.",e),showModal:!1}]},{slug:"deprecated-options",name:"Deprecated Options",actions:[{label:"Deprecated Options",slug:"deprecated-options",shortDescription:"Enable or disable any options that have been deprecated in AIOSEO.",longDescription:"<strong>These options are not guaranteed to work and all support has been dropped.</strong>",showModal:!1,component:"deprecated-options"}]}]},activeTabObject(){return this.tabs.find(e=>e.slug===this.activeTab)}},methods:{isActionDisabled(e){return this.rootStore.aioseo.data.isNetworkAdmin?this.site.blog_id?this.site.blog_id==="network"&&e.network?!1:this.site.blog_id==="network"&&!e.network:!0:!1},isLoading(e){return!!this.doingAction[e.slug]},getSelectedActionObject(e){let o=null;return this.actions.forEach(n=>{const u=n.options.find(t=>t.value===e);u&&(o=u)}),o},maybeDoAction(e,o){if(this.currentAction=e,e.showModal){this.showAreYouSureModal=!0;return}this.doAction(o)},doAction(e){this.doingAction[this.currentAction.slug]=!0,this.showAreYouSureModal=!1,this.doingActionKey++,this.toolsStore.doTask({action:this.currentAction.slug,siteId:this.site.blog_id||this.rootStore.aioseo.data.currentBlogId,data:e}).then(()=>{console.log(`Action "${this.currentAction.label}" has been completed.`)}).catch(o=>{console.error(`Action "${this.currentAction.label}" could not be completed: `,o)}).finally(()=>{this.doingAction[this.currentAction.slug]=!1,this.doingActionKey++})}},beforeMount(){var o;let e=-1;if(this.rootStore.aioseo.data.v3Options&&(e=this.tabs.findIndex(n=>n.slug.toLowerCase()==="migrations"),e!==-1)){const n=this.$t.sprintf('<a href="%1$s" target="_blank">Scheduled Actions</a>',this.rootStore.aioseo.urls.admin.scheduledActions);this.tabs[e].actions.push({label:"Rerun V3 Migration",slug:"restart-v3-migration",shortDescription:"This action restarts the migration from V3 to V4.",longDescription:this.$t.sprintf("All settings will be migrated immediately. However, the post/term meta needs to be migrated via a routine which runs in batches via Action Scheduler. To speed up the post/term meta migration, go to %1$s and run the <code>aioseo_migrate_post_meta</code> or <code>aioseo_migrate_term_meta</code> action.",n),infoComponent:"MigrationInfo",showModal:!0})}(o=this.extraActions)!=null&&o.length&&this.extraActions.forEach(n=>{if(e=this.tabs.findIndex(u=>u.slug.toLowerCase()===n.slug.toLowerCase()),e!==-1){this.tabs[e].actions=this.tabs[e].actions.concat(n.actions);return}this.tabs.push(n)})}},ge={class:"aioseo-tools-debug"},_e={key:0,class:"aioseo-settings-row"},be={class:"select-site"},fe=["innerHTML"],we=["innerHTML"],Ae=["innerHTML"],ve={class:"aioseo-modal-body"},ye=["innerHTML"];function Se(e,o,n,u,t,r){const c=a("core-network-site-selector"),b=a("core-alert"),y=a("core-main-tabs"),f=a("base-button"),_=a("core-settings-row"),S=a("svg-close"),k=a("core-modal"),x=a("core-card");return i(),h("div",ge,[g(x,{slug:"debug","header-text":t.strings.cardLabel},{default:d(()=>[u.rootStore.aioseo.data.isNetworkAdmin?(i(),h("div",_e,[l("div",be,m(t.strings.selectSite),1),g(c,{onSelectedSite:o[0]||(o[0]=s=>t.site=s),"show-network":""})])):A("",!0),g(b,{type:"yellow"},{default:d(()=>[l("div",null,m(t.strings.alertWarning),1),l("div",{innerHTML:t.alertLink},null,8,fe)]),_:1}),(i(),p(y,{internal:"",key:t.tabsKey,tabs:r.tabs,active:t.activeTab,showSaveButton:!1,onChanged:o[1]||(o[1]=s=>t.activeTab=s)},null,8,["tabs","active"])),(i(!0),h(M,null,T(r.activeTabObject.actions,(s,L)=>(i(),p(_,{key:t.activeTab+L,name:s.label,align:""},{content:d(()=>[s.component?(i(),p(C(s.component),{key:0,onUpdate:$=>r.maybeDoAction(s,$),loading:t.doingAction[s.slug],disabled:r.isActionDisabled(s)},null,40,["onUpdate","loading","disabled"])):(i(),p(f,{type:"blue",size:"medium",onClick:$=>r.maybeDoAction(s),loading:t.doingAction[s.slug],key:t.doingActionKey,disabled:r.isActionDisabled(s)},{default:d(()=>[w(m(t.strings.buttonLabel),1)]),_:2},1032,["onClick","loading","disabled"])),l("div",{class:"aioseo-description",innerHTML:s.shortDescription},null,8,we),l("div",{class:"aioseo-description",innerHTML:s.longDescription},null,8,Ae),s.infoComponent?(i(),p(C(s.infoComponent),{key:2})):A("",!0)]),_:2},1032,["name"]))),128)),t.showAreYouSureModal?(i(),p(k,{key:1,"no-header":"",onClose:o[5]||(o[5]=s=>t.showAreYouSureModal=!1)},{body:d(()=>[l("div",ve,[l("button",{class:"close",onClick:o[3]||(o[3]=F(s=>t.showAreYouSureModal=!1,["stop"]))},[g(S,{onClick:o[2]||(o[2]=s=>t.showAreYouSureModal=!1)})]),l("h3",null,m(r.areYouSureTitle),1),l("div",{class:"description",innerHTML:t.strings.cannotBeUndone},null,8,ye),g(f,{type:"blue",size:"medium",onClick:r.doAction},{default:d(()=>[w(m(t.strings.yesDoAction),1)]),_:1},8,["onClick"]),g(f,{type:"gray",size:"medium",onClick:o[4]||(o[4]=s=>t.showAreYouSureModal=!1)},{default:d(()=>[w(m(t.strings.noChangedMind),1)]),_:1})])]),_:1})):A("",!0)]),_:1},8,["header-text"])])}const ke=v(he,[["render",Se]]),Ce={components:{Debug:ke}};function De(e,o,n,u,t,r){const c=a("debug",!0);return i(),p(c)}const Me=v(Ce,[["render",De]]),Te={setup(){return{rootStore:D()}},components:{BadBotBlocker:N,CoreMain:V,DatabaseTools:E,Debug:Me,HtaccessEditor:J,ImportExport:j,RobotsEditor:Q,SystemStatus:X,WpCode:Z},data(){return{strings:{pageName:this.rootStore.aioseo.data.isNetworkAdmin?this.$t.__("Network Tools",this.$td):this.$t.__("Tools",this.$td)}}},computed:{showSaveButton(){return this.$route.name!=="system-status"&&this.$route.name!=="import-export"&&this.$route.name!=="database-tools"&&this.$route.name!=="debug"&&this.$route.name!=="wp-code"}}};function $e(e,o,n,u,t,r){const c=a("core-main");return i(),p(c,{"page-name":t.strings.pageName,"show-save-button":r.showSaveButton},{default:d(()=>[(i(),p(C(e.$route.name)))]),_:1},8,["page-name","show-save-button"])}const Wt=v(Te,[["render",$e]]);export{Wt as default};
