import{n as T,e as W,b as P,u as K,f as A,m as E}from"./links.37929787.js";import{p as O}from"./popup.6fe74774.js";import"./default-i18n.3881921e.js";import{u as H,W as B}from"./Wizard.903ba197.js";import{C as M}from"./index.c39be324.js";import{r as s,c as u,d as o,w as r,o as a,a as n,D as l,z as d,f as h,I as N,J as U,b as f}from"./vue.runtime.esm-bundler.588d3a9f.js";import"./Caret.4d98c50a.js";import{_ as V}from"./_plugin-vue_export-helper.a6f24833.js";import{G,a as I}from"./Row.256ac4c7.js";import"./constants.44daa6bb.js";/* empty css                                              */import"./TruSeoHighlighter.ed998abe.js";import{S as D}from"./Checkmark.cb1bb390.js";import{W as R,a as Y,b as F}from"./Header.ee4a7d94.js";import{W as j,_ as q}from"./Steps.03ff98d8.js";import"./isArrayLikeObject.10b615a9.js";import"./params.f0608262.js";import"./addons.dacbad81.js";import"./upperFirst.d65414ba.js";import"./_stringToArray.a4422725.js";import"./Index.9e89d7ca.js";/* empty css                                              *//* empty css                                            */import"./postContent.a843d374.js";import"./cleanForSlug.a67f7e84.js";import"./Ellipse.60ee808e.js";import"./toFinite.c2274946.js";import"./Logo.5c35a084.js";const J={setup(){const{strings:e}=H();return{connectStore:T(),licenseStore:W(),optionsStore:P(),rootStore:K(),setupWizardStore:A(),composableStrings:e}},components:{CoreAlert:M,GridColumn:G,GridRow:I,SvgCheckmark:D,WizardBody:R,WizardCloseAndExit:j,WizardContainer:Y,WizardHeader:F,WizardSteps:q},mixins:[B],data(){return{error:null,loading:!1,stage:"license-key",localLicenseKey:null,strings:E(this.composableStrings,{enterYourLicenseKey:this.$t.sprintf(this.$t.__("Enter your %1$s License Key",this.$td),"AIOSEO"),boldText:this.$t.sprintf("<strong>%1$s %2$s</strong>","AIOSEO","Lite"),purchasedBoldText:this.$t.sprintf("<strong>%1$s %2$s</strong>","AIOSEO","Pro"),linkText:this.$t.sprintf(this.$t.__("upgrade to %1$s",this.$td),"Pro"),placeholder:this.$t.__("Paste your license key here",this.$td),connect:this.$t.__("Connect",this.$td)})}},watch:{localLicenseKey(e){this.setupWizardStore.licenseKey=e}},computed:{noLicenseNeeded(){return this.$t.sprintf(this.$t.__("You're using %1$s - no license needed. Enjoy!",this.$td)+" 🙂",this.strings.boldText)},link(){return this.$t.sprintf('<strong><a href="%1$s" target="_blank">%2$s</a></strong>',this.$links.utmUrl("general-settings","license-box"),this.strings.linkText)},tooltipText(){return this.$isPro?this.$t.__("To unlock the selected features, please enter your license key below.",this.$td):this.$t.sprintf(this.$t.__("To unlock the selected features, please %1$s and enter your license key below.",this.$td),this.link)},alreadyPurchased(){return this.$t.sprintf(this.$t.__("Already purchased? Simply enter your license key below to connect with %1$s!",this.$td),this.strings.purchasedBoldText)}},methods:{processConnectOrActivate(){if(this.$isPro)return this.processActivateLicense();this.processGetConnectUrl()},processActivateLicense(){this.error=null,this.loading=!0,this.rootStore.loading=!0,this.licenseStore.activate(this.localLicenseKey).then(()=>{this.optionsStore.internalOptions.internal.license.expired=!1,this.setupWizardStore.saveWizard("license-key").then(()=>{this.$router.push(this.setupWizardStore.getNextLink)})}).catch(e=>{if(this.loading=!1,this.localLicenseKey=null,this.rootStore.loading=!1,!e||!e.response||!e.response.body||!e.response.body.error||!e.response.body.licenseData){this.error=this.$t.__("An unknown error occurred, please try again later.",this.$td);return}const i=e.response.body.licenseData;i.invalid?this.error=this.$t.__("The license key provided is invalid. Please use a different key to continue receiving automatic updates.",this.$td):i.disabled?this.error=this.$t.__("The license key provided is disabled. Please use a different key to continue receiving automatic updates.",this.$td):i.expired?this.error=this.licenseKeyExpired:i.activationsError?this.error=this.$t.__("This license key has reached the maximum number of activations. Please deactivate it from another site or purchase a new license to continue receiving automatic updates.",this.$td):(i.connectionError||i.requestError)&&(this.error=this.$t.__("There was an error connecting to the licensing API. Please try again later.",this.$td))})},processGetConnectUrl(){this.loading=!0,this.rootStore.loading=!0,this.connectStore.getConnectUrl({key:this.localLicenseKey,wizard:!0}).then(e=>{if(e.body.url){if(!e.body.popup)return this.loading=!1,this.rootStore.loading=!1,window.open(e.body.url);this.openPopup(e.body.url)}})},openPopup(e){O(e,"_self",600,630,!0,["file","token"],this.completedCallback,this.closedCallback)},completedCallback(e){return e.wizard=!0,this.connectStore.processConnect(e)},closedCallback(e){if(e)return window.location.reload();this.loading=!1,this.rootStore.loading=!1},skipStep(){this.setupWizardStore.saveWizard(),this.$router.push(this.setupWizardStore.getNextLink)}},mounted(){this.localLicenseKey=this.setupWizardStore.licenseKey}},Q={class:"aioseo-wizard-license-key"},X={class:"header"},Z=["innerHTML"],ee={class:"license-cta-box"},te=["innerHTML"],se=["innerHTML"],oe={class:"license-key"},ie=n("input",{type:"text",name:"username",autocomplete:"username",style:{display:"none"}},null,-1),re={class:"go-back"},ne=n("div",{class:"spacer"},null,-1);function ae(e,i,le,_,t,c){const g=s("wizard-header"),k=s("wizard-steps"),S=s("svg-checkmark"),b=s("grid-column"),$=s("grid-row"),L=s("base-input"),m=s("base-button"),v=s("core-alert"),y=s("router-link"),w=s("wizard-body"),z=s("wizard-close-and-exit"),x=s("wizard-container");return a(),u("div",Q,[o(g),o(x,null,{default:r(()=>[o(w,null,{footer:r(()=>[n("div",re,[o(y,{to:_.setupWizardStore.getPrevLink,class:"no-underline"},{default:r(()=>[l("←")]),_:1},8,["to"]),l("   "),o(y,{to:_.setupWizardStore.getPrevLink},{default:r(()=>[l(d(t.strings.goBack),1)]),_:1},8,["to"])]),ne,o(m,{type:"gray",onClick:c.skipStep},{default:r(()=>[l(d(t.strings.skipThisStep),1)]),_:1},8,["onClick"])]),default:r(()=>[o(k),n("div",X,d(t.strings.enterYourLicenseKey),1),e.$isPro?h("",!0):(a(),u("div",{key:0,class:"description",innerHTML:c.noLicenseNeeded},null,8,Z)),n("div",ee,[n("div",{innerHTML:c.tooltipText},null,8,te),o($,null,{default:r(()=>[(a(!0),u(N,null,U(e.getSelectedUpsellFeatures,(p,C)=>(a(),f(b,{sm:"6",key:C},{default:r(()=>[o(S),l(" "+d(p.name),1)]),_:2},1024))),128))]),_:1})]),e.$isPro?h("",!0):(a(),u("div",{key:1,innerHTML:c.alreadyPurchased},null,8,se)),n("form",oe,[ie,o(L,{type:"password",placeholder:t.strings.placeholder,"append-icon":t.localLicenseKey?"circle-check":null,autocomplete:"new-password",modelValue:t.localLicenseKey,"onUpdate:modelValue":i[0]||(i[0]=p=>t.localLicenseKey=p)},null,8,["placeholder","append-icon","modelValue"]),o(m,{type:"green",disabled:!t.localLicenseKey,loading:t.loading,onClick:c.processConnectOrActivate},{default:r(()=>[l(d(t.strings.connect),1)]),_:1},8,["disabled","loading","onClick"])]),t.error?(a(),f(v,{key:2,class:"license-key-error",type:"red",innerHTML:t.error},null,8,["innerHTML"])):h("",!0)]),_:1}),o(z)]),_:1})])}const Be=V(J,[["render",ae]]);export{Be as default};
